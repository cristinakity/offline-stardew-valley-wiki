<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from stardewvalleywiki.com/mediawiki/index.php?title=Modding:Trigger_actions&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 11 Apr 2024 05:50:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>View source for Modding:Trigger actions - Stardew Valley Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!0,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"38288de6ba4fcd64b2c5729d","wgCSPNonce":!1,"wgCanonicalNamespace":"Modding","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":570,"wgPageName":"Modding:Trigger_actions","wgTitle":"Trigger actions","wgCurRevisionId":164776,"wgRevisionId":0,"wgArticleId":14584,"wgIsArticle":!1,"wgIsRedirect":!1,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Modding:Trigger_actions","wgRelevantArticleId":14584,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgMFMode":"stable","wgMFAmc":!1,"wgMFAmcOutreachActive":!1,
"wgMFAmcOutreachUserEligible":!1,"wgMFLazyLoadImages":!0,"wgMFDisplayWikibaseDescriptions":{"search":!1,"nearby":!1,"watchlist":!1,"tagline":!1},"wgMFIsPageContentModelEditable":!0,"wgCargoMapClusteringMinimum":80,"wgCargoMonthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"wgCargoMonthNamesShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgCargoWeekDays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"wgCargoWeekDaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"wgMinervaPermissions":{"watch":!0,"talk":!1},"wgMinervaFeatures":{"beta":!1,"donate":!0,"mobileOptionsLink":!0,"categories":!1,"pageIssues":!0,"talkAtTop":!1,"historyInPageActions":!1,"overflowSubmenu":!1,"tabsOnSpecials":!1,"personalMenu":!1,"mainMenuExpanded":!1,"simplifiedTalk":!0},"wgMinervaDownloadNamespaces":[0],"wgSiteNoticeId":
"1.0"};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","mediawiki.ui.input":"ready","mediawiki.ui.checkbox":"ready","skins.minerva.base.styles":"ready","skins.minerva.content.styles":"ready","skins.minerva.content.styles.images":"ready","mediawiki.hlist":"ready","mediawiki.ui.icon":"ready","mediawiki.ui.button":"ready","skins.minerva.icons.wikimedia":"ready","skins.minerva.mainMenu.icons":"ready","skins.minerva.mainMenu.styles":"ready","mobile.init.styles":"ready","mobile.messageBox.styles":"ready","ext.dismissableSiteNotice.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.startup","skins.minerva.options","skins.minerva.scripts","mobile.init","ext.dismissableSiteNotice"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="load85db.css?lang=en&amp;modules=ext.dismissableSiteNotice.styles%7Cmediawiki.hlist%7Cmediawiki.ui.button%2Ccheckbox%2Cicon%2Cinput%7Cmobile.init.styles%7Cmobile.messageBox.styles%7Cskins.minerva.base.styles%7Cskins.minerva.content.styles%7Cskins.minerva.content.styles.images%7Cskins.minerva.icons.wikimedia%7Cskins.minerva.mainMenu.icons%2Cstyles&amp;only=styles&amp;skin=minerva"/>
<script async="" src="loadc82b.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=minerva&amp;target=mobile"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load1154.css?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=minerva"/>
<meta name="generator" content="MediaWiki 1.35.1"/>
<meta name="robots" content="noindex,nofollow"/>
<meta name="description" content="You do not have permission to edit this page, for the following reason:"/>
<meta name="theme-color" content="#eaecf0"/>
<meta name="viewport" content="initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0, width=device-width"/>
<link rel="manifest" href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/api.php?action=webapp-manifest"/>
<link rel="shortcut icon" href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/extensions/StardewValley/images/favicon.png"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/opensearch_desc.php" title="Stardew Valley Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="../../external.html?link=http://stardewvalleywiki.com/mediawiki/api.php?action=rsd"/>
<link rel="license" href="../../external.html?link=https://creativecommons.org/licenses/by-nc-sa/3.0/"/>
<meta property="og:title" content="View source for Modding:Trigger actions - Stardew Valley Wiki"/>
<meta property="og:site_name" content="Stardew Valley Wiki"/>
<meta property="og:url" content="https://stardewvalleywiki.com/Modding:Trigger_actions"/>
<meta property="og:description" content="← Index"/>
<meta property="og:image" content="https://stardewvalleywiki.com/mediawiki/extensions/StardewValley/images/site_logo_sm.png"/>
<meta property="article:modified_time" content="2024-04-06T18:09:19Z"/>
<meta property="article:published_time" content="2024-04-06T18:09:19Z"/>
<meta property="twitter:site" content="@stardewwiki"/>
<meta property="twitter:title" content="View source for Modding:Trigger actions - Stardew Valley Wiki"/>
<meta property="twitter:description" content="← Index"/>
<meta property="twitter:image" content="https://stardewvalleywiki.com/mediawiki/extensions/StardewValley/images/site_logo_sm.png"/>
<meta property="twitter:card" content="summary_large_image"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"article","name":"View source for Modding:Trigger actions - Stardew Valley Wiki","headline":"View source for Modding:Trigger actions - Stardew Valley Wiki","mainEntityOfPage":"View source for Modding:Trigger actions","identifier":"https:\/\/stardewvalleywiki.com\/Modding:Trigger_actions","url":"https:\/\/stardewvalleywiki.com\/Modding:Trigger_actions","description":"\u2190 Index","dateModified":"2024-04-06T18:09:19Z","datePublished":"2024-04-06T18:09:19Z","image":{"@type":"ImageObject","url":"https:\/\/stardewvalleywiki.com\/mediawiki\/extensions\/StardewValley\/images\/site_logo_sm.png"},"author":{"@type":"Organization","name":"Stardew Valley Wiki","url":"\/\/stardewvalleywiki.com","logo":{"@type":"ImageObject","url":"https:\/\/stardewvalleywiki.com\/mediawiki\/extensions\/StardewValley\/images\/site_logo_sm.png","caption":"Stardew Valley Wiki"}},"publisher":{"@type":"Organization","name":"Stardew Valley Wiki","url":"\/\/stardewvalleywiki.com","logo":{"@type":"ImageObject","url":"https:\/\/stardewvalleywiki.com\/mediawiki\/extensions\/StardewValley\/images\/site_logo_sm.png","caption":"Stardew Valley Wiki"}},"potentialAction":{"@type":"SearchAction","target":"https:\/\/stardewvalleywiki.com\/mediawiki\/index.php?title=Special:Search&search={search_term}","query-input":"required name=search_term"}}</script>
<!--[if lt IE 9]><script src="/mediawiki/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-570 ns-subject page-Modding_Trigger_actions rootpage-Modding_Trigger_actions stable skin-minerva action-edit skin-vector-legacy">
<div id="mw-mf-viewport">
	<div id="mw-mf-page-center">
		<a class="mw-mf-page-center__mask" href="#"></a>
		<header class="header-container header-chrome">
			<form class="header" action="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php" method="get">
				<nav class="navigation-drawer toggle-list view-border-box">
					<input type="checkbox" id="main-menu-input" class="toggle-list__checkbox" role="button" aria-labelledby="mw-mf-main-menu-button">
					<label for="main-menu-input" id="mw-mf-main-menu-button"
						class="mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-menu-base20 mw-ui-icon-flush-left toggle-list__toggle"
						title="Open main menu" data-event-name="ui.mainmenu">Open main menu</label>
					<div id="mw-mf-page-left" class="menu toggle-list__list view-border-box">
	<ul id="p-navigation">
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki" class="mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-home" data-event-name="menu.home"><span>Home</span></a>
			</li>
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Special:Random#/random" class="mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-die " data-event-name="menu.random"><span>Random</span></a>
			</li>
	</ul>
	<ul id="p-personal">
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Modding%3ATrigger+actions&amp;returntoquery=action%3Dedit" class="menu__item--login mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-logIn " data-event-name="menu.login"><span>Log in</span></a>
			</li>
	</ul>
	<ul id="pt-preferences">
			<li class="jsonly">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Special:MobileOptions&amp;returnto=Modding%3ATrigger+actions" class="menu__item--settings mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-settings " data-event-name="menu.settings"><span>Settings</span></a>
			</li>
	</ul>
	<ul class="hlist">
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:About" class="" data-event-name=""><span>About Stardew Valley Wiki</span></a>
			</li>
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:General_disclaimer" class="" data-event-name=""><span>Disclaimers</span></a>
			</li>
	</ul>
</div>

					<label class="main-menu-mask" for="main-menu-input"></label>
				</nav>
				<div class="branding-box">
					<a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki">
						<span>Stardew Valley Wiki</span>
						
					</a>
				</div>
				<div class="search-box">
					<input class="search mw-ui-background-icon-search skin-minerva-search-trigger" type="search" name="search" id="searchInput"
						autocomplete="off" placeholder="Search Stardew Valley Wiki" aria-label="Search Stardew Valley Wiki"
						value="">
				</div>
				<nav class="minerva-user-navigation" aria-label="User navigation">
					<div><button id="searchIcon" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-search-base20 skin-minerva-search-trigger" type="submit">Search</button></div>
					
				</nav>
			</form>
		</header>
		<main id="content" class="mw-body">
			<div class="banner-container">
			<div id="siteNotice"></div>
			</div>
			
			<div class="pre-content heading-holder">
				<div class="page-heading">
					<h1 id="section_0">View source for Modding:Trigger actions</h1>
					<div class="tagline"></div>
				</div>
				
				
				
				<div class="minerva__subtitle">← <a href="../../external.html?link=https://stardewvalleywiki.com/Modding:Trigger_actions" title="Modding:Trigger actions">Modding:Trigger actions</a></div>
			</div>
			
			<div id="bodyContent" class="content"><div id="mw-content-text"><script>function mfTempOpenSection(id){var block=document.getElementById("mf-section-"+id);block.className+=" open-block";block.previousSibling.className+=" open-block";}</script><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in the group: <a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Stardew_Valley_Wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Stardew Valley Wiki:Users (page does not exist)">Users</a>.
</p>
</div><hr />
<p>You can view and copy the source of this page.
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" class="mw-editfont-monospace mw-ui-input" lang="en" dir="ltr" name="wpTextbox1">← [[Modding:Index|Index]]

This page documents '''trigger actions''', which let content packs perform an action when something happens. (C# mods should usually use [[Modding:Modder Guide/APIs/Events|SMAPI events]] instead.)

==Overview==
===Introduction===
A ''trigger action'' consists of two main parts:
* The ''trigger'' is what causes the action to happen. This can be an entry in &lt;samp>Data/TriggerActions&lt;/samp>, an event command, etc. See [[#Triggers|built-in triggers]].
* The ''action'' is a space-delimited string which defines what to do. For example, &lt;code>AddMail Current Robin&lt;/code> adds the &lt;samp>Robin&lt;/samp> letter to the player's [[Modding:Mail data|mailbox]] tomorrow. See [[#Argument format|argument format]] and [[#Actions|built-in actions]].

===Argument format===
Arguments are space-delimited. For example, &lt;code>AddMail Current Abigail_LeoMoved Now&lt;/code> calls the &lt;samp>AddMail&lt;/samp> action with three arguments (player: &lt;samp>Current&lt;/samp>, mail ID: &lt;samp>Abigail_LeoMoved&lt;/samp>, and mail type: &lt;samp>Now&lt;/samp>).

If you have spaces within an argument, you can surround it with quotes to keep it together. For example, &lt;code>AddFriendshipPoints "Mister Qi" 10&lt;/code> has two arguments (&lt;samp>Mister Qi&lt;/samp> and &lt;samp>10&lt;/samp>). You can escape inner quotes with backslashes, like &lt;code>AddFriendshipPoints "Mister \"Qi\"" 10&lt;/code>.

Remember that quotes and backslashes inside JSON strings need to be escaped too. For example, &lt;code>"AddFriendshipPoints \"Mister Qi\" 10"&lt;/code> will send &lt;code>AddFriendshipPoints "Mister Qi" 10&lt;/code> to the game code. Alternatively, you can use single-quotes for the JSON string instead, like &lt;code>'AddFriendshipPoints "Mister Qi" 10'&lt;/code>.

==Actions==
===Built-in actions===
These are the built-in actions which can be used by any [[#Triggers|trigger]]. (Other custom actions may be [[#For C# mod authors|added by C# mods]].)

{| class="wikitable"
|-
! action
! effect
|-
| &lt;samp>AddBuff {{t|buff ID}}&lt;/samp>&lt;br />&lt;samp>RemoveBuff {{t|buff ID}}&lt;/samp>
| Apply or remove a buff ID for the current player.
|-
| &lt;samp>AddConversationTopic {{t|topic ID}} {{t|day duration}}&lt;/samp>
| Start a [[Modding:Dialogue#Conversation topics|conversation topic]] for the given number of days. If the topic is already active, this resets its duration to the given number.
|-
| &lt;samp>RemoveConversationTopic {{t|topic ID}}&lt;/samp>
| End a [[Modding:Dialogue#Conversation topics|conversation topic]], if it's active.
|-
| &lt;samp>AddFriendshipPoints {{t|NPC name}} {{t|count}}&lt;/samp>
| Add {{t|count}} [[Friendship|friendship points]] between the current player and specified NPC. The {{t|count}} can be negative to reduce friendship points.
|-
| &lt;samp>AddItem {{t|item ID}} {{o|count}} {{o|quality}}&lt;/samp>
| Add an item by its [[Modding:Migrate to Stardew Valley 1.6#Custom items|qualified or unqualified item ID]] to the current player's inventory, with an optional count (default 1) and [[Modding:Items#Quality|quality]] (default 0).
|-
| &lt;samp>RemoveItem {{t|item ID}} {{o|count}}&lt;/samp>
| Deduct items by [[Modding:Migrate to Stardew Valley 1.6#Custom items|qualified or unqualified item ID]] from the current player's inventory, up to a max combined stack size of {{o|count}} (default 1).
|-
| &lt;samp>AddMail {{t|player}} {{t|mail ID}} {{o|type}}&lt;/samp>&lt;br />&lt;samp>RemoveMail {{t|player}} {{t|mail ID}} {{o|type}}&lt;/samp>
| Add or remove a [[Modding:Mail data|mail flag or letter]] for the [[#Target player|specified player(s)]].

The {{t|type}} must be one of:
{| class="wikitable"
|-
! type
! effect
|-
| &lt;samp>now&lt;/samp>
| In the player's mailbox now.
|-
| &lt;samp>tomorrow&lt;/samp>
| In the player's list of mail arriving in the mailbox tomorrow.
|-
| &lt;samp>received&lt;/samp>
| In the player's list of received mail (bypassing the mailbox).
|-
| &lt;samp>all&lt;/samp>
| Add or remove it everywhere (mailbox, tomorrow's mailbox, and received mail).
|}

If omitted, the {{t|type}} defaults to &lt;samp>tomorrow&lt;/samp> for &lt;samp>AddMail&lt;/samp> and &lt;samp>all&lt;/samp> for &lt;samp>RemoveMail&lt;/samp>.
|-
| &lt;samp>AddMoney {{t|amount}}&lt;/samp>
| Add the given {{t|amount}} of money for the current player. The {{t|amount}} can be negative to deduct money.
|-
| &lt;samp>AddQuest {{t|quest ID}}&lt;/samp>&lt;br />&lt;samp>RemoveQuest {{t|quest ID}}&lt;/samp>
| Add or remove a [[Modding:Quest data|quest]] for the current player.
|-
| &lt;samp>AddSpecialOrder {{t|order ID}}&lt;/samp>&lt;br />&lt;samp>RemoveSpecialOrder {{t|order ID}}&lt;/samp>
| Add or remove a [[Modding:Special orders|special order]].
|-
| &lt;samp>If {{t|query}} ## {{t|action if true}}&lt;/samp>&lt;br />&lt;samp>If {{t|query}} ## {{t|action if true}} ## {{t|action if false}}&lt;/samp>
| Check a [[Modding:Game state queries|game state query]] and perform an action based on the result.

For example, this only sends a mail if the player doesn't have it in their received, mailbox, or queued-for-tomorrow mail:
&lt;syntaxhighlight lang="js">
"ActionsOnPurchase": [
    "If !PLAYER_HAS_MAIL Current SomeFlag ## AddMail Current SomeFlag"
]
&lt;/syntaxhighlight>
|-
| &lt;samp>IncrementStat {{t|stat key}} {{o|amount}}&lt;/samp>
| Increment a stat value by the given amount (default 1) for the current player. This can be a vanilla stat key (see the &lt;samp>PLAYER_STAT&lt;/samp> [[Modding:Game state queries|game state query]] for a list) or a custom stat key. The amount can be negative to decrement it.
|-
| &lt;samp>MarkActionApplied {{t|player}} {{t|answer ID}} {{o|applied}}&lt;/samp>
| Mark a &lt;samp>Data/TriggerActions&lt;/samp> entry as applied or non-applied for the [[#Target player|specified player(s)]], depending on {{o|applied}} (default &lt;samp>true&lt;/samp>). This can be used to skip or re-run an entry, since &lt;samp>Data/TriggerActions&lt;/samp> entries are only applied once by default.

Note that an entry can't use this to mark ''itself'' unapplied; see [[#Make Data/TriggerActions repeat|''Make &lt;samp>Data/TriggerActions&lt;/samp> repeat'']] if you want to do that.
|-
| &lt;samp>MarkCookingRecipeKnown {{t|player}} {{t|recipe ID}} {{o|known}}&lt;/samp>&lt;br />&lt;samp>MarkCraftingRecipeKnown {{t|player}} {{t|recipe key}} {{o|known}}&lt;/samp>
| Set whether [[#Target player|specified player(s)]] know a [[Modding:Recipe data|cooking or crafting recipe]], depending on {{o|known}} (default &lt;samp>true&lt;/samp>).

Note that forgetting a recipe will also reset its times-cooked/crafted counter to zero.
|-
| &lt;samp>MarkEventSeen {{t|player}} {{t|event ID}} {{o|seen}}&lt;/samp>
| Mark [[Modding:Event data|an event]] as seen or unseen for the [[#Target player|specified player(s)]], depending on {{o|seen}} (default &lt;samp>true&lt;/samp>).
|-
| &lt;samp>MarkQuestionAnswered {{t|player}} {{t|answer ID}} {{o|answered}}&lt;/samp>
| Mark [[Modding:Dialogue#Response IDs|a dialogue answer]] as selected or non-selected for the [[#Target player|specified player(s)]], depending on {{o|answered}} (default &lt;samp>true&lt;/samp>).
|-
| &lt;samp>MarkSongHeard {{t|player}} {{t|song ID}} {{o|heard}}&lt;/samp>
| Mark a song track's cue name heard or non-heard for the [[#Target player|specified player(s)]], depending on {{o|heard}} (default &lt;samp>true&lt;/samp>). This affects whether the song appears in the [[jukebox]] selection.
|-
| &lt;samp>Null&lt;/samp>
| ''(Specialized)'' Does nothing. This is used internally; there's generally no benefit to using it yourself.
|-
| &lt;samp>RemoveTemporaryAnimatedSprites&lt;/samp>
| Remove all temporary animated sprites in the current location. For example, this can be used in the [[Modding:Event data|event]] &lt;samp>setSkipActions&lt;/samp> command to clean up the event's temporary sprites.
|-
| &lt;samp>SetNpcInvisible {{t|NPC name}} {{t|day duration}}&lt;/samp>
| Hide an NPC so they disappear and can't be interacted with for the given number of days. This is used when NPCs go away for a while (e.g. [[Elliott#Fourteen Hearts|Elliott's 14-heart event]]).

'''TODO: can you call this from the farmhand? Atra doesn't think so.'''
|-
| &lt;samp>SetNpcVisible {{t|NPC name}}&lt;/samp>
| End the NPC's invisibility, if applicable.

'''TODO: check to see if can be called from farmhand. Will probably make the NPC visible again, but the daysUntilNotInvisible is NOT synced.'''
|}

===Target player===
Some conditions have a {{t|player}} argument. This can be one of...
{| class="wikitable"
|-
! value
! result
|-
| &lt;samp>All&lt;/samp>
| Apply the action to all players (regardless of whether they're online).
|-
| &lt;samp>Current&lt;/samp>
| Apply to the local player.
|-
| &lt;samp>Host&lt;/samp>
| Apply to the main player.
|}

==Triggers==
===&lt;samp>Data/TriggerActions&lt;/samp>===
&lt;samp>Data/TriggerActions&lt;/samp> is a data asset which lets you dynamically perform actions when the conditions are met.

For example, consider this [[Modding:Content Patcher|Content Patcher]] patch:
{{#tag:syntaxhighlight|&lt;nowiki>
{
    "Format": "&lt;/nowiki>{{Content Patcher version}}&lt;nowiki>",
    "Changes": [
        {
            "Action": "EditData",
            "Target": "Data/TriggerActions",
            "Entries": {
                "{{ModId}}_OnLeoMoved": {
                    "Id": "{{ModId}}_OnLeoMoved",
                    "Trigger": "DayEnding",
                    "Condition": "PLAYER_HAS_MAIL Host leoMoved",
                    "Actions": [
                        "AddMail Current {{ModId}}_Abigail_LeoMoved",
                        "AddConversationTopic {{ModId}}_LeoMoved 5"
                    ]
                }
            }
        }
    ]
}
&lt;/nowiki>|lang=js}}

You can read that like: "''When the player is going to sleep, if Leo has moved to the valley, then [[Modding:Mail data|send a letter]] and start [[Modding:Dialogue#Conversation topics|a conversation topic]]''".

Each entry in &lt;samp>Data/TriggerActions&lt;/samp> only runs once by default, though you can use the &lt;samp>MarkActionApplied&lt;/samp> action to re-enable one.

&lt;samp>Data/TriggerActions&lt;/samp> consists of a list of models with these fields:

{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Id&lt;/samp>
| The [[Modding:Common data field types#Unique string ID|unique string ID]] for this trigger action.
|-
| &lt;samp>Trigger&lt;/samp>
| When to apply the trigger action. This must be one or more of these values (space-delimited):

{| class="wikitable"
|-
! trigger
! effect
|-
| &lt;samp>DayStarted&lt;/samp>
| Raised when the player starts a day, after either sleeping or loading.
|-
| &lt;samp>DayEnding&lt;/samp>
| Raised when the player is going to sleep. This happens immediately before the game changes the date, sets up the new day, and saves.
|-
| &lt;samp>LocationChanged&lt;/samp>
| Raised when the player arrives in a location.
|-
| ''other''
| Other custom triggers may be [[#For C# mod authors|added by C# mods]].
|}
|-
| &lt;samp>Actions&lt;/samp>
| ''(Optional)'' The actions to perform, as a list of strings matching the [[#Actions|action format]].
|-
| &lt;samp>Action&lt;/samp>
| ''(Optional)'' A single action to perform, matching the [[#Actions|action format]].

This is just a shortcut for &lt;samp>Actions&lt;/samp> with one action. Technically you can use both together, but usually you should just pick one property to set.
|-
| &lt;samp>HostOnly&lt;/samp>
| ''(Optional)'' Whether this trigger action can only run for the main player. If true, the action will be ignored for farmhands in [[multiplayer]].
|-
| &lt;samp>MarkActionApplied&lt;/samp>
| ''(Optional)'' Whether to mark the action applied when it's applied. Default true.

* If true: the action is added to the player's &lt;samp>triggerActionsRun&lt;/samp> list, [[Modding:Game state queries|queries]] like &lt;samp>PLAYER_HAS_RUN_TRIGGER_ACTION&lt;/samp> will return true, and the action won't run again (unless you use the &lt;samp>MarkActionApplied&lt;/samp> action to mark it unapplied).
* If false: the action can repeat immediately when the same trigger is raised, and [[Modding:Game state queries|queries]] like &lt;samp>PLAYER_HAS_RUN_TRIGGER_ACTION&lt;/samp> will return false for it.
|-
| &lt;samp>Condition&lt;/samp>
| ''(Optional)'' A [[Modding:Game state queries|game state query]] which indicates whether this action can be applied currently. Defaults to always true.
|-
| &lt;samp>CustomFields&lt;/samp>
| ''(Optional)'' The [[Modding:Migrate to Stardew Valley 1.6#Custom data fields|custom fields]] for this entry.
|}

===Elsewhere===
You can also run an action directly from...

&lt;ul>
&lt;li>A [[Modding:Dialogue|dialogue string]] using the &lt;samp>$action&lt;/samp> command. For example:
&lt;syntaxhighlight lang="js">
"Mon": "Hi there! Here's 10g and a parsnip, don't spend it all at once.#$action AddMoney 10#$action AddItem (O)24"
&lt;/syntaxhighlight>&lt;/li>

&lt;li>An [[Modding:Event data|event script]] using the &lt;samp>action&lt;/samp> command. For example:
&lt;syntaxhighlight lang="js">
"{{ModId}}_Event": "continue/64 15/farmer 64 16 2 Abigail 64 18 0/pause 1500/speak Abigail \"Hi. Here's 10g and a parsnip.\"/action AddMoney 10/action AddItem (O)24/pause 500/end"
&lt;/syntaxhighlight>

See also the &lt;samp>setSkipActions&lt;/samp> command.
&lt;/li>

&lt;li>A [[Modding:Mail data|mail letter]] using the &lt;samp>%action&lt;/samp> command. For example:
&lt;syntaxhighlight lang="js">
"{{ModId}}_Letter": "Hey there!^Here's 10g and a parsnip. Take care!^   -Abigail%action AddMoney 10%% %action Additem (O)24%%[#]A gift from Abigail"
&lt;/syntaxhighlight>&lt;/li>

&lt;li>The [[Modding:Console commands|SMAPI console window]] using the &lt;samp>debug action&lt;/samp> console command. For example:
&lt;pre>> debug action "AddMoney 10"

Applied action 'AddMoney 10'.&lt;/pre>&lt;/li>
&lt;/ul>

==For C# mod authors==
===Using trigger actions in C# data===
Trigger actions are mainly meant for [[Modding:Content Patcher|Content Patcher packs]]. C# mod can use [[Modding:Modder Guide/APIs/Events|SMAPI's events]] instead, which are much more flexible and efficient (unless you want to let content packs edit your trigger actions).

===Extensibility===
C# mods can use the &lt;samp>StardewValley.Triggers.TriggerActionManager&lt;/samp> class to interact with trigger actions.

For example, you can...
&lt;ul>
&lt;li>Add and raise a new trigger type:
&lt;syntaxhighlight lang="js">
// register custom trigger type
TriggerActionManager.RegisterTrigger("Some.ModId_OnItemReceived");

// run actions in Data/TriggerActions for the custom trigger
TriggerActionManager.Raise("Some.ModId_OnItemReceived", new[] { item, index }); // trigger can pass optional trigger arguments
&lt;/syntaxhighlight>&lt;/li>

&lt;li>Or add a new action:
&lt;syntaxhighlight lang="js">
TriggerActionManager.RegisterAction("Some.ModId_PlaySound", this.PlaySound);

...

/// &lt;inheritdoc cref="TriggerActionDelegate" />
public static bool PlaySound(string[] args, TriggerActionContext context, out string error)
{
    // get args
    if (!ArgUtility.TryGet(args, 1, out string soundId, out string error, allowBlank: false))
        return false;

    // apply
    Game1.playSound(soundId);
    return true;
}
&lt;/syntaxhighlight>&lt;/li>

&lt;li>Or run an action string:
&lt;syntaxhighlight lang="js">
// NOTE: this is just an example of how to run an action. This is meant to support actions specified in data or content
// packs. If you want to send mail (or perform other actions) in C#, it's better to call the C# APIs directly instead.
string action = "AddMail Current Robin Now";
if (!TriggerActionManager.TryRunAction(action, out string error, out Exception ex))
    Game1.log.Error($"Failed running action '{action}': {error}", ex);
&lt;/syntaxhighlight>&lt;/li>
&lt;/ul>

To avoid conflicts, custom trigger names should be [[Modding:Common data field types#Unique string ID|unique string IDs]].

==FAQs==
===Trigger actions vs map actions===
''Actions'' can refer to two different systems:

* ''Trigger actions'' (this page) let you perform generic background tasks that can be done anytime, like sending a letter or starting a quest. These can be triggered automatically based on conditions, or via commands in dialogue, events, etc.
* ''[[Modding:Maps|Map actions]]'' refer to the &lt;samp>Action&lt;/samp> and &lt;samp>TouchAction&lt;/samp> map properties, which do something when you walk on or interact with a map tile. These can perform a wide array of map- and interaction-specific things like showing a message box, changing the map, opening shop menus, etc. These only work in maps, and generally don't make sense in other contexts.

Aside from the similar names, they're not interchangeable and there's fairly little overlap.

===Make &lt;samp>Data/TriggerActions&lt;/samp> repeat===
By default, each entry in &lt;samp>Data/TriggerActions&lt;/samp> is only applied once per player.

There are two main ways to repeat actions:
&lt;ul>
&lt;li>To make it repeatable immediately, set &lt;samp>"MarkActionApplied": false&lt;/samp> on the &lt;samp>Data/TriggerActions&lt;/samp> entry.&lt;/li>
&lt;li>To enable repeating at a different time, you can use the &lt;samp>MarkActionApplied&lt;/samp> action to forget that it was applied.

For example, this patch will set alternating 'work' or 'weekend' mail flags depending on the day of week:
{{#tag:syntaxhighlight|&lt;nowiki>
{
    "Format": "&lt;/nowiki>{{Content Patcher version}}&lt;nowiki>",
    "Changes": [
        {
            "Action": "EditData",
            "Target": "Data/TriggerActions",
            "Entries": {
                // set 'work' flag on weekdays, and reset weekend action
                "{{ModId}}_Work": {
                    "Id": "{{ModId}}_Work",
                    "Trigger": "DayStarted",
                    "Condition": "!DAY_OF_WEEK Saturday Sunday",
                    "Actions": [
                        "AddMail Current {{ModId}}_Work Received",
                        "RemoveMail Current {{ModId}}_Weekend",
                        "MarkActionApplied Current {{ModId}}_Weekend false"
                    ]
                },

                // set 'weekend' flag on weekends, and reset work action
                "{{ModId}}_Weekend": {
                    "Id": "{{ModId}}_Weekend",
                    "Trigger": "DayStarted",
                    "Condition": "DAY_OF_WEEK Saturday Sunday",
                    "Actions": [
                        "AddMail Current {{ModId}}_Weekend Received",
                        "RemoveMail Current {{ModId}}_Work",
                        "MarkActionApplied Current {{ModId}}_Work false"
                    ]
                },
            }
        }
    ]
}
&lt;/nowiki>|lang=js}}

[[Category:Modding]]
</textarea><div class="templatesUsed"><div class="mw-templatesUsedExplanation"><p>Templates used on this page:
</p></div><ul>
<li><a href="../../external.html?link=https://stardewvalleywiki.com/Template:Content_Patcher_version" title="Template:Content Patcher version">Template:Content Patcher version</a> (<a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Template:Content_Patcher_version&amp;action=edit" title="Template:Content Patcher version">view source</a>) </li><li><a href="../../external.html?link=https://stardewvalleywiki.com/Template:O" title="Template:O">Template:O</a> (<a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Template:O&amp;action=edit" title="Template:O">view source</a>) </li><li><a href="../../external.html?link=https://stardewvalleywiki.com/Template:T" title="Template:T">Template:T</a> (<a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Template:T&amp;action=edit" title="Template:T">view source</a>) </li></ul></div><p id="mw-returnto">Return to <a href="../../external.html?link=https://stardewvalleywiki.com/Modding:Trigger_actions" title="Modding:Trigger actions">Modding:Trigger actions</a>.</p>
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="../../external.html?link=https://stardewvalleywiki.com/Modding:Trigger_actions">https://stardewvalleywiki.com/Modding:Trigger_actions</a>"</div>
</div>
			<div class="post-content" id="page-secondary-actions">
			
			</div>
		</main>
		<footer class="mw-footer minerva-footer">
		
		<div class="post-content footer-content">
			
			<h2>Stardew Valley Wiki</h2>
			<div class="license">Content is available under <a class="external" rel="nofollow" href="../../external.html?link=https://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike</a> unless otherwise noted.</div>
			<ul class="footer-info hlist hlist-separated">
				
			</ul>
			<ul class="footer-places hlist hlist-separated">
				<li id="footer-places-privacy"><a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:Privacy_policy" title="Stardew Valley Wiki:Privacy policy">Privacy policy</a></li><li id="footer-places-about"><a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:About" title="Stardew Valley Wiki:About">About Stardew Valley Wiki</a></li><li id="footer-places-disclaimer"><a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:General_disclaimer" title="Stardew Valley Wiki:General disclaimer">Disclaimers</a></li><li id="footer-places-desktop-toggle"><a id="mw-mf-display-toggle" href="../../external.html?link=http://stardewvalleywiki.com/mediawiki/index.php?title=Modding:Trigger_actions&amp;action=edit&amp;mobileaction=toggle_view_desktop">Desktop</a></li>
			</ul>
		</div>
		</footer>
	</div>
</div>
<div class="mw-notification-area" data-mw="interface"></div>
<!-- v:8.3.0 -->

<script src="../../external.html?link=https://www.googletagmanager.com/gtag/js?id=G-1S37VCXXZ9" async=""></script><script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1S37VCXXZ9', {"anonymize_ip":true});
</script>

<script>(window.NORLQ=window.NORLQ||[]).push(function(){var ns,i,p,img;ns=document.getElementsByTagName('noscript');for(i=0;i<ns.length;i++){p=ns[i].nextSibling;if(p&&p.className&&p.className.indexOf('lazy-image-placeholder')>-1){img=document.createElement('img');img.setAttribute('src',p.getAttribute('data-src'));img.setAttribute('width',p.getAttribute('data-width'));img.setAttribute('height',p.getAttribute('data-height'));img.setAttribute('alt',p.getAttribute('data-alt'));p.parentNode.replaceChild(img,p);}}});</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":89});});</script>		</body>
		
<!-- Mirrored from stardewvalleywiki.com/mediawiki/index.php?title=Modding:Trigger_actions&action=edit by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 11 Apr 2024 05:50:21 GMT -->
</html>
		