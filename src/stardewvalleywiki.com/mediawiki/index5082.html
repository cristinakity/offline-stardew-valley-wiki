<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">


<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>View source for Modding:Machines - Stardew Valley Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!0,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"0a905c927b9ecf60e299227a","wgCSPNonce":!1,"wgCanonicalNamespace":"Modding","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":570,"wgPageName":"Modding:Machines","wgTitle":"Machines","wgCurRevisionId":172361,"wgRevisionId":0,"wgArticleId":16460,"wgIsArticle":!1,"wgIsRedirect":!1,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Modding:Machines","wgRelevantArticleId":16460,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgMFMode":"stable","wgMFAmc":!1,"wgMFAmcOutreachActive":!1,
"wgMFAmcOutreachUserEligible":!1,"wgMFLazyLoadImages":!0,"wgMFDisplayWikibaseDescriptions":{"search":!1,"nearby":!1,"watchlist":!1,"tagline":!1},"wgMFIsPageContentModelEditable":!0,"wgCargoMapClusteringMinimum":80,"wgCargoMonthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"wgCargoMonthNamesShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgCargoWeekDays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"wgCargoWeekDaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"wgMinervaPermissions":{"watch":!0,"talk":!1},"wgMinervaFeatures":{"beta":!1,"donate":!0,"mobileOptionsLink":!0,"categories":!1,"pageIssues":!0,"talkAtTop":!1,"historyInPageActions":!1,"overflowSubmenu":!1,"tabsOnSpecials":!1,"personalMenu":!1,"mainMenuExpanded":!1,"simplifiedTalk":!0},"wgMinervaDownloadNamespaces":[0]};RLSTATE={
"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","mediawiki.ui.input":"ready","mediawiki.ui.checkbox":"ready","skins.minerva.base.styles":"ready","skins.minerva.content.styles":"ready","skins.minerva.content.styles.images":"ready","mediawiki.hlist":"ready","mediawiki.ui.icon":"ready","mediawiki.ui.button":"ready","skins.minerva.icons.wikimedia":"ready","skins.minerva.mainMenu.icons":"ready","skins.minerva.mainMenu.styles":"ready","mobile.init.styles":"ready","mobile.messageBox.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.startup","skins.minerva.options","skins.minerva.scripts","mobile.init"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="loadb780.css?lang=en&amp;modules=mediawiki.hlist%7Cmediawiki.ui.button%2Ccheckbox%2Cicon%2Cinput%7Cmobile.init.styles%7Cmobile.messageBox.styles%7Cskins.minerva.base.styles%7Cskins.minerva.content.styles%7Cskins.minerva.content.styles.images%7Cskins.minerva.icons.wikimedia%7Cskins.minerva.mainMenu.icons%2Cstyles&amp;only=styles&amp;skin=minerva"/>
<script async="" src="loadc82b.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=minerva&amp;target=mobile"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load1154.css?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=minerva"/>
<meta name="generator" content="MediaWiki 1.35.1"/>
<meta name="robots" content="noindex,nofollow"/>
<meta name="description" content="You do not have permission to edit this page, for the following reason:"/>
<meta name="theme-color" content="#eaecf0"/>
<meta name="viewport" content="initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0, width=device-width"/>
<link rel="manifest" href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/api.php?action=webapp-manifest"/>
<link rel="shortcut icon" href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/extensions/StardewValley/images/favicon.png"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/opensearch_desc.php" title="Stardew Valley Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="../../external.html?link=http://stardewvalleywiki.com/mediawiki/api.php?action=rsd"/>
<link rel="license" href="../../external.html?link=https://creativecommons.org/licenses/by-nc-sa/3.0/"/>
<meta property="og:title" content="View source for Modding:Machines - Stardew Valley Wiki"/>
<meta property="og:site_name" content="Stardew Valley Wiki"/>
<meta property="og:url" content="https://stardewvalleywiki.com/Modding:Machines"/>
<meta property="og:description" content="← Index"/>
<meta property="og:image" content="https://stardewvalleywiki.com/mediawiki/extensions/StardewValley/images/site_logo_sm.png"/>
<meta property="twitter:site" content="@stardewwiki"/>
<meta property="twitter:title" content="View source for Modding:Machines - Stardew Valley Wiki"/>
<meta property="twitter:description" content="← Index"/>
<meta property="twitter:image" content="https://stardewvalleywiki.com/mediawiki/extensions/StardewValley/images/site_logo_sm.png"/>
<meta property="twitter:card" content="summary_large_image"/>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"article","name":"View source for Modding:Machines - Stardew Valley Wiki","headline":"View source for Modding:Machines - Stardew Valley Wiki","mainEntityOfPage":"View source for Modding:Machines","identifier":"https:\/\/stardewvalleywiki.com\/Modding:Machines","url":"https:\/\/stardewvalleywiki.com\/Modding:Machines","description":"\u2190 Index","dateModified":"2024-06-10T04:46:37Z","datePublished":"2024-06-10T04:46:37Z","image":{"@type":"ImageObject","url":"https:\/\/stardewvalleywiki.com\/mediawiki\/extensions\/StardewValley\/images\/site_logo_sm.png"},"author":{"@type":"Organization","name":"Stardew Valley Wiki","url":"\/\/stardewvalleywiki.com","logo":{"@type":"ImageObject","url":"https:\/\/stardewvalleywiki.com\/mediawiki\/extensions\/StardewValley\/images\/site_logo_sm.png","caption":"Stardew Valley Wiki"}},"publisher":{"@type":"Organization","name":"Stardew Valley Wiki","url":"\/\/stardewvalleywiki.com","logo":{"@type":"ImageObject","url":"https:\/\/stardewvalleywiki.com\/mediawiki\/extensions\/StardewValley\/images\/site_logo_sm.png","caption":"Stardew Valley Wiki"}},"potentialAction":{"@type":"SearchAction","target":"https:\/\/stardewvalleywiki.com\/mediawiki\/index.php?title=Special:Search&search={search_term}","query-input":"required name=search_term"}}</script>
<!--[if lt IE 9]><script src="/mediawiki/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-570 ns-subject page-Modding_Machines rootpage-Modding_Machines stable skin-minerva action-edit skin-vector-legacy">
<div id="mw-mf-viewport">
	<div id="mw-mf-page-center">
		<a class="mw-mf-page-center__mask" href="#"></a>
		<header class="header-container header-chrome">
			<form class="header" action="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php" method="get">
				<nav class="navigation-drawer toggle-list view-border-box">
					<input type="checkbox" id="main-menu-input" class="toggle-list__checkbox" role="button" aria-labelledby="mw-mf-main-menu-button">
					<label for="main-menu-input" id="mw-mf-main-menu-button"
						class="mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-menu-base20 mw-ui-icon-flush-left toggle-list__toggle"
						title="Open main menu" data-event-name="ui.mainmenu">Open main menu</label>
					<div id="mw-mf-page-left" class="menu toggle-list__list view-border-box">
	<ul id="p-navigation">
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki" class="mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-home" data-event-name="menu.home"><span>Home</span></a>
			</li>
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Special:Random#/random" class="mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-die " data-event-name="menu.random"><span>Random</span></a>
			</li>
	</ul>
	<ul id="p-personal">
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Modding%3AMachines&amp;returntoquery=action%3Dedit" class="menu__item--login mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-logIn " data-event-name="menu.login"><span>Log in</span></a>
			</li>
	</ul>
	<ul id="pt-preferences">
			<li class="jsonly">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Special:MobileOptions&amp;returnto=Modding%3AMachines" class="menu__item--settings mw-ui-icon mw-ui-icon-before mw-ui-icon-minerva-settings " data-event-name="menu.settings"><span>Settings</span></a>
			</li>
	</ul>
	<ul class="hlist">
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:About" class="" data-event-name=""><span>About Stardew Valley Wiki</span></a>
			</li>
			<li class="">
			    <a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:General_disclaimer" class="" data-event-name=""><span>Disclaimers</span></a>
			</li>
	</ul>
</div>

					<label class="main-menu-mask" for="main-menu-input"></label>
				</nav>
				<div class="branding-box">
					<a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki">
						<span>Stardew Valley Wiki</span>
						
					</a>
				</div>
				<div class="search-box">
					<input class="search mw-ui-background-icon-search skin-minerva-search-trigger" type="search" name="search" id="searchInput"
						autocomplete="off" placeholder="Search Stardew Valley Wiki" aria-label="Search Stardew Valley Wiki"
						value="">
				</div>
				<nav class="minerva-user-navigation" aria-label="User navigation">
					<div><button id="searchIcon" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-search-base20 skin-minerva-search-trigger" type="submit">Search</button></div>
					
				</nav>
			</form>
		</header>
		<main id="content" class="mw-body">
			<div class="banner-container">
			<div id="siteNotice"></div>
			</div>
			
			<div class="pre-content heading-holder">
				<div class="page-heading">
					<h1 id="section_0">View source for Modding:Machines</h1>
					<div class="tagline"></div>
				</div>
				
				
				
				<div class="minerva__subtitle">← <a href="../../external.html?link=https://stardewvalleywiki.com/Modding:Machines" title="Modding:Machines">Modding:Machines</a></div>
			</div>
			
			<div id="bodyContent" class="content"><div id="mw-content-text"><script>function mfTempOpenSection(id){var block=document.getElementById("mf-section-"+id);block.className+=" open-block";block.previousSibling.className+=" open-block";}</script><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in the group: <a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Stardew_Valley_Wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Stardew Valley Wiki:Users (page does not exist)">Users</a>.
</p>
</div><hr />
<p>You can view and copy the source of this page.
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" class="mw-editfont-monospace mw-ui-input" lang="en" dir="ltr" name="wpTextbox1">← [[Modding:Index|Index]]

This page explains how to add/edit machines in the game data. This is an advanced guide for modders.

==Definitions==
A "machine" is a placeable object which takes input and/or produces output based on the rules in &lt;samp>Data/Machines&lt;/samp>. A machine doesn't need to do both (e.g. [[Solar Panel|solar panels]] produce output without accepting input), and it's not necessarily something players would intuitively consider a machine (e.g. [[incubator]]s and [[Mushroom Log|mushroom logs]] are machines).

==Data format==
You can add/edit machine logic by editing the &lt;samp>Data/Machines&lt;/samp> [[Modding:Editing XNB files|asset]].

This consists of a string → model lookup, where...
* The key is the [[Modding:Common data field types#Item ID|'''qualified''' item ID]] for the item which acts as a machine (like &lt;samp>(BC)127&lt;/samp> for [[The Cave|mushroom boxes]]).
* The value is a model with the fields listed below.

===Item processing rules===
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>OutputRules&lt;/samp>
| The output produced by this machine. If multiple output rules can be produced, the first available one is selected. This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Id&lt;/samp>
| The [[Modding:Common data field types#Unique string ID|unique string ID]] for this rule within the current machine (it doesn't need to be unique between machines).
|-
| &lt;samp>Triggers&lt;/samp>
| When to apply this output rule. This can list any number of triggers; the output will apply if any of them match.

This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Id&lt;/samp>
| The [[Modding:Common data field types#Unique string ID|unique string ID]] for this trigger within the current rule.
|-
| &lt;samp>Trigger&lt;/samp>
| ''(Optional)'' When this output rule applies. Defaults to &lt;samp>ItemPlacedInMachine&lt;/samp>. The possible values are...
* &lt;samp>ItemPlacedInMachine&lt;/samp>: apply this rule when an item is placed into the machine. This is the most common machine behavior.
* &lt;samp>OutputCollected&lt;/samp>: apply this rule when the machine's previous output is collected. An output-collected rule won't require or consume the input items, and the input item will be the previous output. For example, this is used to reload the [[crystalarium]].
* &lt;samp>MachinePutDown&lt;/samp>: apply this rule when the machine is put down. For example, this is used to start the [[Worm Bin|worm bin]].
* &lt;samp>DayUpdate&lt;/samp>: apply this rule when a new day starts, if it isn't already processing output. For example, this is used for the [[Soda Machine|soda machine]].

You can specify multiple values, like &lt;code>"Trigger": "DayUpdate, MachinePutDown, OutputCollected"&lt;/code>.
|-
| &lt;samp>RequiredItemId&lt;/samp>
| ''(Optional)'' The qualified or unqualified item ID for the item to match, if the trigger is &lt;samp>ItemPlacedInMachine&lt;/samp> or &lt;samp>OutputCollected&lt;/samp>. Defaults to allowing any item ID.
|-
| &lt;samp>RequiredTags&lt;/samp>
| ''(Optional)'' The [[Modding:Context tags|context tags]] to match against input items, if the trigger is &lt;samp>ItemPlacedInMachine&lt;/samp> or &lt;samp>OutputCollected&lt;/samp>. An item must have all of the listed tags to select this rule. You can negate a tag with &lt;samp>!&lt;/samp> (like &lt;code>"RequiredTags": [ "bone_item", "!fossil_item" ]&lt;/code> for bone items that aren't fossils).
|-
| &lt;samp>RequiredCount&lt;/samp>
| ''(Optional)'' The required stack size for the input item, if the trigger is &lt;samp>ItemPlacedInMachine&lt;/samp> or &lt;samp>OutputCollected&lt;/samp>. Default 1.
|-
| &lt;samp>Condition&lt;/samp>
| ''(Optional)'' A [[Modding:Game state queries|game state query]] which indicates whether this trigger should be checked. Item-only tokens are valid for this check if the trigger is &lt;samp>ItemPlacedInMachine&lt;/samp> or &lt;samp>OutputCollected&lt;/samp>. Defaults to always true.
|}
|-
| &lt;samp>OutputItem&lt;/samp>
| The items produced by this machine. If multiple output entries match, one will be selected randomly unless you specify &lt;samp>UseFirstValidOutput&lt;/samp>. This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| ''common fields''
| See [[Modding:Item queries#Item spawn fields|item spawn fields]] for the generic item fields supported by machine output.

Notes:
&lt;ul>
&lt;li>If &lt;samp>ItemId&lt;/samp> or &lt;samp>RandomItemId&lt;/samp> is set to an [[Modding:Item queries|item query]] which returns multiple items, one item will be selected at random.&lt;/li>
&lt;li>The &lt;samp>ItemId&lt;/samp> and &lt;samp>RandomItemId&lt;/samp> can optionally contain special tokens, which will be replaced before the item ID is parsed. For example, you can use &lt;code>FLAVORED_ITEM Wine DROP_IN_ID&lt;/code> to create a wine for whatever item was placed in the machine.
{| class="wikitable"
|-
! token
! replaced with
|-
| &lt;samp>DROP_IN_ID&lt;/samp>
| The qualified item ID for the item placed in the machine.
|-
| &lt;samp>DROP_IN_PRESERVE&lt;/samp>
| If the item placed into the machine is a flavored item like Apple Juice or Tuna Roe, the ''unqualified'' item ID for the flavor item (e.g. the apple in Apple Wine). Otherwise &lt;samp>0&lt;/samp>.
|-
| &lt;samp>NEARBY_FLOWER_ID&lt;/samp>
| The item ID for a flower within 5 tiles of the machine, or &lt;samp>-1&lt;/samp> if no flower is found. For example, [[Bee House|bee houses]] produce &lt;code>FLAVORED_ITEM Honey NEARBY_FLOWER_ID&lt;/code>.
|}
&lt;/li>
&lt;li>The &lt;samp>ObjectInternalName&lt;/samp> can optionally contain &lt;samp>{0}&lt;/samp>, which will be replaced with the input item's internal name. This is used to prevent flavored items from stacking (''e.g.'' apple [[wine]] and blueberry wine).&lt;/li>
&lt;li>The &lt;samp>Condition&lt;/samp> field will check the ''input'' (not output) item for item-related conditions.&lt;/li>
&lt;/ul>
|-
| &lt;samp>PreserveType&lt;/samp>
| ''(Optional)'' The produced item's preserved item type, if applicable. This sets the equivalent flag on the output item. The valid values are &lt;samp>Jelly&lt;/samp>, &lt;samp>Juice&lt;/samp>, &lt;samp>Pickle&lt;/samp>, &lt;samp>Roe&lt;/samp> or &lt;samp>AgedRoe&lt;/samp>, and &lt;samp>Wine&lt;/samp>. Defaults to none.
|-
| &lt;samp>PreserveId&lt;/samp>
| ''(Optional)'' The produced item's preserved unqualified item ID, if applicable. For example, [[Wine|blueberry wine]] has its preserved item ID set to the [[blueberry]] ID. This can be set to &lt;samp>DROP_IN&lt;/samp> to use the input item's ID. Default none.
|-
| &lt;samp>CopyColor&lt;/samp>
| ''(Optional)'' Whether to inherit the color of the input item if it was a &lt;samp>ColoredObject&lt;/samp>. This mainly affects [[roe]]. Default false.
|-
| &lt;samp>CopyPrice&lt;/samp>
| ''(Optional)'' Whether to inherit the base price of the input item (before &lt;samp>PriceModifiers&lt;/samp> are applied). This is ignored if the input or output aren't both object (&lt;samp>(O)&lt;/samp>)-type.
|-
| &lt;samp>CopyQuality&lt;/samp>
| ''(Optional)'' Whether to inherit the quality of the input item (before &lt;samp>QualityModifiers&lt;/samp> are applied).
|-
| &lt;samp>PriceModifiers&lt;/samp>&lt;br />&lt;samp>PriceModifiers&lt;/samp>
| ''(Optional)'' [[Modding:Migrate to Stardew Valley 1.6#Quantity modifiers|Quantity modifiers]] applied to the output item's price. Default none.
|-
| &lt;samp>IncrementMachineParentSheetIndex&lt;/samp>
| ''(Optional)'' An amount by which to increment the machine's spritesheet index while it's processing this output. This stacks with the &lt;samp>ShowNextIndexWhenLoaded&lt;/samp> or &lt;samp>ShowNextIndexWhileWorking&lt;/samp> field. Default 0.
|-
| &lt;samp>OutputMethod&lt;/samp>
| ''(Optional, specialized)'' A C# method which decides which item to produce. If set, the &lt;samp>ItemId&lt;/samp> field is optional and ignored.

This must be specified in the form &lt;samp>{{t|full type name}}: {{t|method name}}&lt;/samp> (like &lt;samp>StardewValley.Object, Stardew Valley: OutputSolarPanel&lt;/samp>). The method must be static and match the game's &lt;samp>MachineOutputDelegate&lt;/samp> method signature:
&lt;syntaxhighlight lang="c#">
/// &lt;summary>Get the output item to produce.&lt;/summary>
/// &lt;param name="machine">The machine instance for which to produce output.&lt;/param>
/// &lt;param name="inputItem">The item being dropped into the machine, if applicable.&lt;/param>
/// &lt;param name="probe">Whether the machine is only checking whether the input is valid. If so, the input/machine shouldn't be changed and no animations/sounds should play.&lt;/param>
/// &lt;param name="outputData">The item output data from &lt;c>Data/Machines&lt;/c> for which output is being created, if applicable.&lt;/param>
/// &lt;param name="overrideMinutesUntilReady">The in-game minutes until the item will be ready to collect, if set. This overrides the equivalent fields in the machine data if set.&lt;/param>
/// &lt;returns>Returns the item to produce, or &lt;c>null&lt;/c> if none should be produced.&lt;/returns>
public static Item GetOutput(Object machine, Item inputItem, bool probe, MachineItemOutput outputData, out int? overrideMinutesUntilReady);
&lt;/syntaxhighlight>

If this method returns null, the machine won't output anything.
|-
| &lt;samp>CustomData&lt;/samp>
| Machine-specific data provided to the machine logic, if applicable.

For example, the cask uses this to set the aging rate for each item:
&lt;syntaxhighlight lang="js">
"OutputItem": {
    "OutputMethod": "StardewValley.Objects.Cask, Stardew Valley: OutputCask",
    "CustomData": {
        "AgingMultiplier": 4
    }
}
&lt;/syntaxhighlight>
|}
|-
| &lt;samp>UseFirstValidOutput&lt;/samp>
| ''(Optional)'' If multiple &lt;samp>OutputItem&lt;/samp> entries match, whether to use the first match instead of choosing one randomly. Default false.
|-
| &lt;samp>MinutesUntilReady&lt;/samp>&lt;br />&lt;samp>DaysUntilReady&lt;/samp>
| ''(Optional)'' The number of in-game minutes or days until the output is ready to collect. If both days and minutes are specified, days are used. If none are specified, the item will be ready instantly.
|-
| &lt;samp>InvalidCountMessage&lt;/samp>
| ''(Optional)'' If set, overrides the machine's main &lt;samp>InvalidCountMessage&lt;/samp> field.
|-
| &lt;samp>RecalculateOnCollect&lt;/samp>
| ''(Optional)'' Whether to regenerate the output right before the player collects it, similar to [[Bee House|bee houses]]. If the new item is null, the original output is returned instead.
|}
|-
| &lt;samp>AdditionalConsumedItems&lt;/samp>
| ''(Optional)'' A list of extra items required before &lt;samp>OutputRules&lt;/samp> will be checked. If specified, every listed item must be present in the player, [[hopper]], or chest inventory (depending how the machine is being loaded).

This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>ItemId&lt;/samp>
| The [[Modding:Common data field types#Item ID|qualified or unqualified item ID]] for the required item.
|-
| &lt;samp>RequiredCount&lt;/samp>
| ''(Optional)'' The required stack size for the item matching &lt;samp>ItemId&lt;/samp>. Default 1.
|-
| &lt;samp>InvalidCountMessage&lt;/samp>
| ''(Optional)'' If set, overrides the machine's main &lt;samp>InvalidCountMessage&lt;/samp> field.
|}
|-
| &lt;samp>AllowFairyDust&lt;/samp>
| ''(Optional)'' Whether the player can add [[Fairy Dust|fairy dust]] to speed up the machine. Default true.
|-
| &lt;samp>ReadyTimeModifiers&lt;/samp>
| ''(Optional)'' [[Modding:Migrate to Stardew Valley 1.6#Quantity modifiers|Quantity modifiers]] applied to the produced item's processing time. The modifier conditions can use item-only tokens, which will check the ''input'' (not output) item.
|-
| &lt;samp>ReadyTimeModifierMode&lt;/samp>
| ''(Optional)'' A [[Modding:Migrate to Stardew Valley 1.6#Quantity modifiers|quantity modifier mode]] which indicates what to do if multiple modifiers apply at the same time. Default &lt;samp>Stack&lt;/samp>.
|}

===Behavior tweaks===
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>OnlyCompleteOvernight&lt;/samp>
| ''(Optional)'' Whether the machine should only produce output overnight. If enabled and it finishes processing during the day, it'll pause until its next day update. Default false.
|-
| &lt;samp>PreventTimePass&lt;/samp>
| ''(Optional)'' A list of cases when the machine should be paused, so the timer on any item being produced doesn't decrement. Possible values:
{| class="wikitable"
|-
! value
! effect
|-
| &lt;samp>Outside&lt;/samp>&lt;br />&lt;samp>Inside&lt;/samp>
| Pause when placed in an outside or inside location. For example, [[Bee House|bee houses]] don't work inside.
|-
| &lt;samp>Spring&lt;/samp>&lt;br />&lt;samp>Summer&lt;/samp>&lt;br />&lt;samp>Fall&lt;/samp>&lt;br />&lt;samp>Winter&lt;/samp>
| Pause in the given season. For example, [[Bee House|bee houses]] don't work in winter.
|-
|-
| &lt;samp>Sun&lt;/samp>&lt;br />&lt;samp>Rain&lt;/samp>
| Pause on days with the given weather.
|-
| &lt;samp>Always&lt;/samp>
| Always pause the machine. This is used in specialized cases where the timer is handled by [[#Advanced logic|advanced machine logic]].
|}
|-
| &lt;samp>AllowLoadWhenFull&lt;/samp>
| ''(Optional)'' Whether the player can drop a new item into the machine before it's done processing the last one (like the [[crystalarium]]). The previous item will be lost. Default false.
|-
| &lt;samp>ClearContentsOvernightCondition&lt;/samp>
| ''(Optional)'' A [[Modding:Game state queries|game state query]] which indicates whether the machine should be emptied overnight, so any current output will be lost. Defaults to always false.
|}

===Audio &amp; visuals===
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>LoadEffects&lt;/samp>&lt;br />&lt;samp>WorkingEffects&lt;/samp>
| ''(Optional)'' The cosmetic effects shown when an item is loaded into the machine (for &lt;samp>LoadEffects&lt;/samp>), or while it's processing the item (for &lt;samp>WorkingEffects&lt;/samp>, based on the &lt;samp>WorkingEffectChance&lt;/samp> probability). Both default to none. These consist of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Condition&lt;/samp>
| ''(Optional)'' A [[Modding:Game state queries|game state query]] which indicates whether this effect should be played. For item queries, you can check the input item (&lt;samp>Input&lt;/samp) or output item (&lt;samp>Target&lt;/samp>). Defaults to always true.
|-
| &lt;samp>Sounds&lt;/samp>
| ''(Optional)'' The audio to play. This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Id&lt;/samp>
| The [[Modding:Audio|audio cue ID]] to play.
|-
| &lt;samp>Delay&lt;/samp>
| ''(Optional)'' The number of milliseconds until the sound should play. Default 0.
|}

Defaults to no sound.
|-
| &lt;samp>ShakeDuration&lt;/samp>
| ''(Optional)'' A duration in milliseconds during which the machine sprite should shake. Default none.
|-
| &lt;samp>Frames&lt;/samp>
| ''(Optional)'' The animation to apply to the machine sprite, specified as a list of offsets relative to the base sprite index. Default none.
|-
| &lt;samp>Interval&lt;/samp>
| ''(Optional)'' The number of milliseconds for which each frame in &lt;samp>Frames&lt;/samp> is kept on-screen. Default 100.
|-
| &lt;samp>TemporarySprites&lt;/samp>
| ''(Optional)'' The temporary animated sprites to show. This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Id&lt;/samp>
| The [[Modding:Common data field types#Unique string ID|unique string ID]] for this rule within the current machine (it doesn't need to be unique between machines).
|-
| &lt;samp>Texture&lt;/samp>
| The asset name for the texture (under the game's &lt;samp>Content&lt;/samp> folder) for the animated sprite.
|-
| &lt;samp>SourceRect&lt;/samp>
| The pixel area for the first animated frame within the &lt;samp>Texture&lt;/samp>, specified as an object with &lt;samp>X&lt;/samp>, &lt;samp>Y&lt;/samp>, &lt;samp>Width&lt;/samp>, and &lt;samp>Height&lt;/samp> fields.
|-
| &lt;samp>Condition&lt;/samp>
| ''(Optional)'' A [[Modding:Game state queries|game state query]] which indicates whether to add this temporary sprite.
|-
| &lt;samp>PositionOffset&lt;/samp>
| ''(Optional)'' A pixel offset applied to the sprite, relative to the top-left corner of the machine's collision box, specified as an object with &lt;samp>X&lt;/samp> and &lt;samp>Y&lt;/samp> fields. Defaults to (0, 0).
|-
| &lt;samp>Color&lt;/samp>
| ''(Optional)'' A tint color to apply to the sprite. See [[Modding:Common data field types#Color|color format]]. Default &lt;samp>White&lt;/samp> (no tint).
|-
| &lt;samp>AlphaFade&lt;/samp>&lt;br />&lt;samp>Loops&lt;/samp>&lt;br />&lt;samp>Rotation&lt;/samp>&lt;br />&lt;samp>RotationChange&lt;/samp>&lt;br />&lt;samp>ScaleChange&lt;/samp>&lt;br />&lt;samp>SortOffset&lt;/samp>
| ''(Optional)'' See equivalent fields in the [[Modding:Event data|&lt;samp>temporaryAnimatedSprite&lt;/samp> event command]]. Default 0.
|-
| &lt;samp>Frames&lt;/samp>&lt;br />&lt;samp>Scale&lt;/samp>
| ''(Optional)'' See equivalent fields in the [[Modding:Event data|&lt;samp>temporaryAnimatedSprite&lt;/samp> event command]]. Default 1.
|-
| &lt;samp>Interval&lt;/samp>
| ''(Optional)'' See equivalent fields in the [[Modding:Event data|&lt;samp>temporaryAnimatedSprite&lt;/samp> event command]]. Default 100.
|-
| &lt;samp>Flicker&lt;/samp>&lt;br />&lt;samp>Flip&lt;/samp>
| ''(Optional)'' See equivalent fields in the [[Modding:Event data|&lt;samp>temporaryAnimatedSprite&lt;/samp> event command]]. Default false.
|}
|}
|-
| &lt;samp>WorkingEffectChance&lt;/samp>
| ''(Optional)'' The percentage chance to apply &lt;samp>WorkingEffects&lt;/samp> each time the day starts or the in-game clock changes, as a value between 0 (never) and 1 (always). Default 0.33.
|-
| &lt;samp>LightWhileWorking&lt;/samp>
| ''(Optional)'' The light emitted by the machine while it's processing an item. Default none.

This consists of a list of models with these fields: 
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Radius&lt;/samp>
| ''(Optional)'' The size of the area covered by the light effect, as a multiplier of the default radius (like &lt;samp>1.5&lt;/samp> for an area 50% wider than the default). Default 1.
|-
| &lt;samp>Color&lt;/samp>
| ''(Optional)'' A tint color to apply to the light. See [[Modding:Common data field types#Color|color format]]. Default &lt;samp>White&lt;/samp> (no tint).
|}
|-
| &lt;samp>WobbleWhileWorking&lt;/samp>
| ''(Optional)'' Whether the machine sprite should bulge in &amp; out while it's processing an item. Default false.
|-
| &lt;samp>ShowNextIndexWhileWorking&lt;/samp>&lt;br />&lt;samp>ShowNextIndexWhenReady&lt;/samp>
| ''(Optional)'' Whether to show the next sprite in the machine's spritesheet while it's processing an item (&lt;samp>ShowNextIndexWhileWorking&lt;/samp>) or ready (&lt;samp>ShowNextIndexWhenReady&lt;/samp>). Default false.
|}

===Player interaction messages===
These only apply when the player interacts with a chest directly, instead of using a [[hopper]] or mod like {{nexus mod|1063|Automate}}.

{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>InvalidItemMessage&lt;/samp>
| ''(Optional)'' A [[Modding:Tokenizable strings|tokenizable string]] for the message shown in a toaster notification if the player tries to input an item that isn't accepted by the machine.
|-
| &lt;samp>InvalidItemMessageCondition&lt;/samp>
| ''(Optional)'' A [[Modding:Game state queries|game state query]] which indicates whether &lt;samp>InvalidItemMessage&lt;/samp> should be shown. This can use item-related queries like &lt;samp>ITEM_TYPE&lt;/samp>. Defaults to always true.
|-
| &lt;samp>InvalidCountMessage&lt;/samp>
| ''(Optional)'' A [[Modding:Tokenizable strings|tokenizable string]] for the message shown in a toaster notification if the input inventory doesn't contain this item, unless overridden by &lt;samp>InvalidCountMessage&lt;/samp> under &lt;samp>OutputRules&lt;/samp>.

This can use extra custom tokens:
* &lt;samp>[ItemCount]&lt;/samp>: the number of remaining items needed. For example, if you're holding three and need five, &lt;samp>[ItemCount]&lt;/samp> will be replaced with &lt;samp>2&lt;/samp>.
|}

===Advanced logic===
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>InteractMethod&lt;/samp>
| ''(Optional)'' A C# method invoked when the player interacts with the machine when it doesn't have output ready to harvest.

This must be specified in the form &lt;samp>{{t|full type name}}: {{t|method name}}&lt;/samp> (like &lt;samp>StardewValley.Object, Stardew Valley: SomeInteractMethod&lt;/samp>). The method must be static and match the game's &lt;samp>MachineInteractDelegate&lt;/samp> method signature:
&lt;syntaxhighlight lang="c#">
/// &lt;summary>The method signature for a custom &lt;see cref="MachineData.InteractMethod"/> method.&lt;/summary>
/// &lt;param name="machine">The machine instance for which to produce output.&lt;/param>
/// &lt;param name="location">The location containing the machine.&lt;/param>
/// &lt;param name="player">The player using the machine.&lt;/param>
/// &lt;returns>Returns whether the interaction was handled.&lt;/returns>
public static bool InteractWithMachine(Object machine, GameLocation location, Farmer player);
&lt;/syntaxhighlight>
|-
| &lt;samp>HasInput&lt;/samp>&lt;br />&lt;samp>HasOutput&lt;/samp>
| ''(Optional)'' Whether to force adding the &lt;samp>machine_input&lt;/samp> or &lt;samp>machine_output&lt;/samp> [[Modding:Items#Context tags|context tags]] respectively. This isn't needed for most machines, since they'll be set based on the &lt;samp>OutputRules&lt;/samp> field. Default false.
|-
| &lt;samp>IsIncubator&lt;/samp>
| ''(Optional)'' Whether this machine acts as an incubator when placed in a building, so players can incubate eggs in it. Default false.

This is used by the [[incubator]] and [[Ostrich Incubator|ostrich incubator]]. The game logic assumes there's only one such machine in each building, so this generally shouldn't be used by custom machines that can be built in a vanilla [[barn]] or [[coop]].
|-
| &lt;samp>StatsToIncrementWhenLoaded&lt;/samp>&lt;br />&lt;samp>StatsToIncrementWhenHarvested&lt;/samp>
| ''(Optional)'' The game stat counters to increment when an item is placed in the machine (&lt;samp>StatsToIncrementWhenLoaded&lt;/samp>) or when the processed output is collected (&lt;samp>StatsToIncrementWhenHarvested&lt;/samp>). Default none. This consists of a list of models with these fields:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>Id&lt;/samp>
| The [[Modding:Common data field types#Unique string ID|unique string ID]] for this entry within the current list.
|-
| &lt;samp>StatName&lt;/samp>
| The name of the stat counter field in &lt;samp>Game1.stats&lt;/samp>. Stat names are case-insensitive.
|-
| &lt;samp>RequiredItemId&lt;/samp>
| ''(Optional)'' If set, only increment the stat if the main input item has this qualified or unqualified item ID.
|-
| &lt;samp>RequiredTags&lt;/samp>
| ''(Optional)'' If set, only increment the stat if the main input item has ''all'' of these [[Modding:Context tags|context tags]]. You can negate a tag with &lt;samp>!&lt;/samp> (like &lt;code>"RequiredTags": [ "bone_item", "!fossil_item" ]&lt;/code> for bone items that aren't fossils).
|}

This can be used to increment both built-in stats (like &lt;samp>GeodesCracked&lt;/samp> for the [[Geode Crusher|geode crusher]]) and custom stats. Using a [[Modding:Common data field types#Unique string ID|unique string ID]] is strongly recommended for custom stats to avoid conflicts.
|-
| &lt;samp>ExperienceGainOnHarvest&lt;/samp>
| ''(Optional)'' Experience points to grant on harvesting from this machine. For example, set to &lt;code>"Farming 7 Fishing 5"&lt;/code> to grant 7 Farming and 5 Fishing xp.
|-
| &lt;samp>CustomFields&lt;/samp>
| The [[Modding:Common data field types#Custom fields|custom fields]] for this entry.
|}

==For C# mods==
===Interacting with machines===
Stardew Valley 1.6 adds two &lt;samp>Object&lt;/samp> fields for reference:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>lastOutputRuleId&lt;/samp>
| If this is a machine, the output rule ID for the rule being processed by the machine (if any).
|-
| &lt;samp>lastInputItem&lt;/samp>
| If this is a machine, the item that was dropped into the machine to start the current output (if any).
|}

And a few methods for processing items:
{| class="wikitable"
|-
! field
! effect
|-
| &lt;samp>IsMachineWorking()&lt;/samp>
| Get whether the machine is currently processing an item.
|-
| &lt;samp>ShouldTimePassForMachine(location)&lt;/samp>
| Get whether the machine should be updated in the given location. For example, this will return false for [[Solar Panel|solar panels]] placed indoors, or outdoors on a cloudy day.
|-
| &lt;samp>GetMachineData()&lt;/samp>
| Get the underlying machine data from &lt;samp>Data/Machines&lt;/samp>.
|-
| &lt;samp>PlaceInMachine(…)&lt;/samp>
| Try to place an item in the machine using the rules from &lt;samp>Data/Machines&lt;/samp>. This returns a boolean which indicates whether the machine was successfully started.
|-
| &lt;samp>OutputMachine(…)&lt;/samp>
| Try to set the machine output given the input item and an optional output rule to apply. Most code should call &lt;samp>PlaceInMachine&lt;/samp> instead.
|}

A lot of the generic machine logic is also handled by a new &lt;samp>MachineDataUtility&lt;/samp> class, which lets C# mods interact with machine data more directly. For example, you can check which output a machine would produce without actually updating the machine.

[[Category:Modding]]
</textarea><div class="templatesUsed"><div class="mw-templatesUsedExplanation"><p>Templates used on this page:
</p></div><ul>
<li><a href="../../external.html?link=https://stardewvalleywiki.com/Template:Nexus_mod" title="Template:Nexus mod">Template:Nexus mod</a> (<a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Template:Nexus_mod&amp;action=edit" title="Template:Nexus mod">view source</a>) </li><li><a href="../../external.html?link=https://stardewvalleywiki.com/Template:T" title="Template:T">Template:T</a> (<a href="../../external.html?link=https://stardewvalleywiki.com/mediawiki/index.php?title=Template:T&amp;action=edit" title="Template:T">view source</a>) </li></ul></div><p id="mw-returnto">Return to <a href="../../external.html?link=https://stardewvalleywiki.com/Modding:Machines" title="Modding:Machines">Modding:Machines</a>.</p>
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="../../external.html?link=https://stardewvalleywiki.com/Modding:Machines">https://stardewvalleywiki.com/Modding:Machines</a>"</div>
</div>
			<div class="post-content" id="page-secondary-actions">
			
			</div>
		</main>
		<footer class="mw-footer minerva-footer">
		
		<div class="post-content footer-content">
			
			<h2>Stardew Valley Wiki</h2>
			<div class="license">Content is available under <a class="external" rel="nofollow" href="../../external.html?link=https://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike</a> unless otherwise noted.</div>
			<ul class="footer-info hlist hlist-separated">
				
			</ul>
			<ul class="footer-places hlist hlist-separated">
				<li id="footer-places-privacy"><a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:Privacy_policy" title="Stardew Valley Wiki:Privacy policy">Privacy policy</a></li><li id="footer-places-about"><a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:About" title="Stardew Valley Wiki:About">About Stardew Valley Wiki</a></li><li id="footer-places-disclaimer"><a href="../../external.html?link=https://stardewvalleywiki.com/Stardew_Valley_Wiki:General_disclaimer" title="Stardew Valley Wiki:General disclaimer">Disclaimers</a></li><li id="footer-places-desktop-toggle"><a id="mw-mf-display-toggle" href="../../external.html?link=http://stardewvalleywiki.com/mediawiki/index.php?title=Modding:Machines&amp;action=edit&amp;mobileaction=toggle_view_desktop">Desktop</a></li>
			</ul>
		</div>
		</footer>
	</div>
</div>
<div class="mw-notification-area" data-mw="interface"></div>
<!-- v:8.3.0 -->

<script src="../../external.html?link=https://www.googletagmanager.com/gtag/js?id=G-1S37VCXXZ9" async=""></script><script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1S37VCXXZ9', {"anonymize_ip":true});
</script>

<script>(window.NORLQ=window.NORLQ||[]).push(function(){var ns,i,p,img;ns=document.getElementsByTagName('noscript');for(i=0;i<ns.length;i++){p=ns[i].nextSibling;if(p&&p.className&&p.className.indexOf('lazy-image-placeholder')>-1){img=document.createElement('img');img.setAttribute('src',p.getAttribute('data-src'));img.setAttribute('width',p.getAttribute('data-width'));img.setAttribute('height',p.getAttribute('data-height'));img.setAttribute('alt',p.getAttribute('data-alt'));p.parentNode.replaceChild(img,p);}}});</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":127});});</script>		</body>
		

</html>
